<!https://kangax.github.io/html-minifier/>
<!DOCTYPE html>
<html lang="en">
	<head>

		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
		<title>Wifi RGB - {{}}</title>
	    <script src='https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.0.4/jscolor.min.js'></script>
    <script>

      var off = '{"command":"off"}'
      var reset = '{"command":"resetSettings"}'
      function sendCommand(command) {
					//alert(command);
          var data = 'command=' + command;
          var request = new XMLHttpRequest();
          request.open('POST', '/', true);
          request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
          request.send(data);
      }
      function update(jscolor) {
          sendRGB(Math.round(jscolor.rgb[0]),Math.round(jscolor.rgb[1]),Math.round(jscolor.rgb[2]));
          sendCommand(command);
      }
      function updateSliders(){
        var r = document.getElementById("r").value;
        var g = document.getElementById("g").value;
        var b = document.getElementById("b").value;
        sendRGB(r,g,b);
      }
      function sendRGB(r,g,b){
        var command = '{"command":"setRGB","r":';
        command = command + r;
        command = command +',"g":' + g;
        command = command +',"b":' + b + '}';
        sendCommand(command);
        document.getElementById("r").value = r;
        document.getElementById("g").value = g;
        document.getElementById("b").value = b;
      }
			function sendKelvin(k){
        var command = '{"command":"setKelvin","kelvin":';
        command = command + k + '}';
        sendCommand(command);
      }

			function setBootColour(){
					var jscolor = document.getElementById("jsbootColour");
					var command = '{"command":"setBootColour","r":';
	        command = command + Math.round(jscolor.jscolor.rgb[0]);
	        command = command +',"g":' + Math.round(jscolor.jscolor.rgb[1]);
	        command = command +',"b":' + Math.round(jscolor.jscolor.rgb[2]) + '}';
	        sendCommand(command);
			}
			function clearBootColour(){
				sendCommand('{"command":"clearBootColour"}');
			}

      function updateBrightness(b) {
          var command = '{"command":"setBrightness","brightness":' + b + '}';
          sendCommand(command);
      }

			function restartDevice(){
				sendCommand('{"command":"restart"}');
			}
			function randomFade(){
				timespan = document.getElementById("t").value;
				sendCommand('{"command":"startRandomColours","timespan":' + timespan + '}');
			}
			function rainbow(){
				timespan = document.getElementById("t").value;
				sendCommand('{"command":"startRainbow","timespan":' + timespan + '}');
			}
			function flash(){
				timespan = document.getElementById("t").value;
				sendCommand('{"command":"startFlash","timespan":' + timespan + '}');
			}
			function stopAll(){
				sendCommand('{"command":"off"}');
			}

      function resetSettings(){
        var r = confirm("Are you sure you want to reset all the settings?");
        if (r == true) {sendCommand(reset);}
      }
			function openTab(evt, tabName) {
			    // Declare all variables
			    var i, tabcontent, tablinks;

			    // Get all elements with class="tabcontent" and hide them
			    tabcontent = document.getElementsByClassName("tabcontent");
			    for (i = 0; i < tabcontent.length; i++) {
			        tabcontent[i].style.display = "none";
			    }

			    // Get all elements with class="tablinks" and remove the class "active"
			    tablinks = document.getElementsByClassName("tablinks");
			    for (i = 0; i < tablinks.length; i++) {
			        tablinks[i].className = tablinks[i].className.replace(" active", "");
			    }

			    // Show the current tab, and add an "active" class to the link that opened the tab
			    document.getElementById(tabName).style.display = "block";
			    evt.currentTarget.className += " active";
			}

    </script>

		<style>
		.c{text-align: center;}
		div,input{font-size:1em;}
		input{width:95%;}
		body{text-align: center; font-family:verdana;}
		button{border:0;  border-radius:0.3rem;    background-color:#1fa3ec;  color:#fff;
			width:20%;   line-height:2rem;     font-size:1rem;    cursor: pointer;    margin: 4px 2px;
			box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);}
		.q{float: right; width: 64px; text-align: right;}
		button:hover {opacity: 0.75;}
		.cl{display: inline-block;  float: center;  width:20%;}
		sliderss > * {  vertical-align: middle; display: inline-block;}
		/* Style the list */
		#tabs ul
		{
			margin:0;
			padding:0;
			list-style-type:none;
			position:relative;
			display:block;
			height:40px;
			font-size:15px;
			font-weight: bold;
			border-bottom:1px solid #000000;
			border-top:1px solid #000000;
			text-align: center;
		}

		#tabs li
		{
			display: inline-block;
			margin-left: 5px;
			padding:0;
			margin-right: 5px;
		}

		#tabs li a
		{
			display:block;
			float:left;
			color:#000000;
			height:32px;
			text-decoration:none;
			padding:8px 10px 0px 10px;
			border-left:1px solid #000000;
			border-right:1px solid #000000;
		}

		#tabs li a:hover
		{
			color:#FFFFFF;
			height:32px;
			background-color: #ddd;
		}

		#tabs li a:focus, .active {
		    background-color: #ccc;
		}

		.tabcontent {
		    display: none;
		    padding: 6px 12px;
		    border: 1px solid #ccc;
		    border-top: none;
				width:320px
		}




		</style>
	</head>
	<body>
		<div style="text-align:center;display:inline-block;min-width:250px;">
      <h3>WiFi RGB Controller - {{}}</h3>
			<div id="tabs">
			<ul>
			  <li><a href="javascript:void(0)" class="tablinks" id="colours" onclick="openTab(event, 'Colours')">Colours</a></li>
				<li><a href="javascript:void(0)" class="tablinks" id="colours" onclick="openTab(event, 'Effects')">Effects</a></li>
				<li><a href="javascript:void(0)" class="tablinks" id="settings" onclick="openTab(event, 'Settings')">Settings</a></li>
			</ul>
		</div>
			<div id="Colours" class="tabcontent">
	      <h4>Colour Select</h4>
	      <input class='jscolor' onchange='update(this.jscolor)' value='FFFEFD'>
	      <br><br>
	      <button class="cl" style="background-color:red" onclick="sendRGB(255,0,0)">Red</button>
	      <button class="cl" style="background-color:green" onclick="sendRGB(0,255,0)">Green</button>
	      <button class="cl" style="background-color:blue" onclick="sendRGB(0,0,255)">Blue</button>
	      <button class="cl" style="color:black; background-color:white" onclick="sendRGB(255,255,255)">White</button>
	      <br><br>
	      <sliderss>
	          <label>R:</label>
	          <input type="range" id="r" value="0" name="r" min="0" max="255" style="width: 70%" onchange="updateSliders();">
	          <br>
	          <label>G:</label>
	          <input type="range" id="g"value="0" name="g" min="0" max="255" style="width: 70%" onchange="updateSliders();">
	          <br>
	          <label>B:</label>
	          <input type="range" id="b" value="0" name="b" min="0" max="255" style="width: 70%" onchange="updateSliders();">
	      </sliderss>
				<h4>Kelvin Scale</h4>
				<label>800</label>
				<input type="range" id="r" value="0" name="r" min="800" max="7000" style="width: 70%" onchange="sendKelvin(this.value);">
				<label>7000</label>
				<br>
	      <h4>Brightness</h4>
	      <input type="range" min="0" max="100" value="100" onchange="updateBrightness(this.value/100);" >
	      <br><br>
	      <button class="cl" style="width:50%" onclick="sendCommand(off)">Turn Off</button>
	      <br>
				<h4>Set Boot Colour</h4>
				<input class='jscolor' id="jsbootColour" value='FFFEFD'>
				<button class="cl" onclick="setBootColour()">Apply</button>
				<button class="cl" onclick="clearBootColour()">Clear</button>
				<br/>
			</div>
			<div id="Effects" class="tabcontent">
				<h4>Speed (ms)</h4>
				<label>100</label>
				<input type="range" id="t" value="1000" name="r" min="100" max="7000" style="width: 60%">
				<label>7000</label>
				<br/><br/>
				<button style="width:50%" onclick="randomFade()">Random Fade</button>
				<br/><br/>
				<button style="width:50%" onclick="flash()">Flash</button>
				<br/><br/>
				<button style="width:50%" onclick="stopAll()">Stop All</button>
				<br/><br/>
			</div>
			<div id="Settings" class="tabcontent">
				<button style="width:50%" onclick="restartDevice()">Restart</button>
				<br/><br/>
				<button style="width:50%" onclick="resetSettings()">Reset Settings</button>
				<br/><br/>
			</div>
		</div>
		<script>
			document.getElementById("colours").click();
		</script>
	</body>
</html>
